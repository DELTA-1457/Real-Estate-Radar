<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤‡∏≠‡∏™‡∏±‡∏á‡∏´‡∏≤‡∏Ø (AI Engine)</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f0f4f8; margin: 0; padding: 20px; display: flex; justify-content: center; align-items: center; min-height: 100vh; }
        .container { background-color: white; padding: 30px; border-radius: 12px; box-shadow: 0 8px 16px rgba(0,0,0,0.1); width: 100%; max-width: 450px; }
        h2 { text-align: center; color: #2c3e50; margin-bottom: 25px; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; color: #34495e; font-weight: 600; font-size: 14px; }
        input, select { width: 100%; padding: 12px; border: 1px solid #cbd5e1; border-radius: 6px; box-sizing: border-box; font-size: 16px; transition: border-color 0.3s; }
        input:focus, select:focus { outline: none; border-color: #3b82f6; }
        button { width: 100%; padding: 14px; background-color: #3b82f6; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 16px; font-weight: bold; margin-top: 15px; transition: background-color 0.3s; }
        button:hover { background-color: #2563eb; }
        #result { margin-top: 20px; padding: 20px; border-radius: 8px; text-align: center; font-size: 18px; font-weight: bold; display: none; }
        .success { background-color: #dcfce7; color: #166534; border: 1px solid #bbf7d0; }
        .error { background-color: #fee2e2; color: #991b1b; border: 1px solid #fecaca; }
        .loading { text-align: center; margin-top: 15px; color: #3b82f6; display: none; font-weight: bold; }
        .score-number { font-size: 36px; color: #15803d; display: block; margin: 10px 0; }
        .calculation-note { font-size: 12px; color: #64748b; margin-top: 5px; text-align: right; }
    </style>
</head>
<body>
    <div class="container">
        <h2>üè¢ ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏î</h2>
        
        <div class="form-group">
            <label for="zone">‡∏ó‡∏≥‡πÄ‡∏• (Zone):</label>
            <select id="zone">
                <option value="thonglor">‡∏ó‡∏≠‡∏á‡∏´‡∏•‡πà‡∏≠ (Thonglor)</option>
                <option value="sukhumvit">‡∏™‡∏∏‡∏Ç‡∏∏‡∏°‡∏ß‡∏¥‡∏ó (Sukhumvit)</option>
                <option value="ratchada">‡∏£‡∏±‡∏ä‡∏î‡∏≤ (Ratchada)</option>
                <option value="bangna">‡∏ö‡∏≤‡∏á‡∏ô‡∏≤ (Bangna)</option>
                <option value="other">‡∏≠‡∏∑‡πà‡∏ô‡πÜ (Other)</option>
            </select>
        </div>

        <div class="form-group">
            <label for="total_price">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢‡∏£‡∏ß‡∏° (‡∏ö‡∏≤‡∏ó):</label>
            <input type="number" id="total_price" placeholder="‡πÄ‡∏ä‡πà‡∏ô 3500000" required>
        </div>

        <div class="form-group">
            <label for="area">‡∏Ç‡∏ô‡∏≤‡∏î‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏´‡πâ‡∏≠‡∏á (‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏°‡∏ï‡∏£):</label>
            <input type="number" id="area" placeholder="‡πÄ‡∏ä‡πà‡∏ô 35" required>
        </div>

        <div class="form-group">
            <label for="distance">‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏£‡∏ñ‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ (‡πÄ‡∏°‡∏ï‡∏£):</label>
            <input type="number" id="distance" placeholder="‡πÄ‡∏ä‡πà‡∏ô 300" required>
        </div>

        <div class="form-group">
            <label for="age">‡∏≠‡∏≤‡∏¢‡∏∏‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ (‡∏õ‡∏µ):</label>
            <input type="number" id="age" placeholder="‡πÄ‡∏ä‡πà‡∏ô 5" required>
        </div>

        <button onclick="calculateScore()">‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ú‡∏•‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</button>
        <div id="loading" class="loading">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏°‡∏≠‡∏á‡∏Å‡∏•... ‚è≥</div>
        <div id="result"></div>
    </div>

    <script>
        async function calculateScore() {
            // 1. ‡∏î‡∏∂‡∏á‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
            const zone = document.getElementById('zone').value;
            const totalPrice = parseFloat(document.getElementById('total_price').value);
            const area = parseFloat(document.getElementById('area').value);
            const distance = parseFloat(document.getElementById('distance').value);
            const age = parseInt(document.getElementById('age').value);

            const resultDiv = document.getElementById('result');
            const loadingDiv = document.getElementById('loading');

            // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ñ‡∏£‡∏ö‡πÑ‡∏´‡∏° ‡πÅ‡∏•‡∏∞‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô 0
            if (!totalPrice || !area || area <= 0 || isNaN(distance) || isNaN(age)) {
                resultDiv.style.display = 'block';
                resultDiv.className = 'error';
                resultDiv.innerText = '‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡πÅ‡∏•‡∏∞‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏£‡∏±‡∏ö';
                return;
            }

            // 2. ‡πÉ‡∏´‡πâ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÅ‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≠‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏°‡∏ï‡∏£‡πÉ‡∏´‡πâ‡∏Å‡πà‡∏≠‡∏ô
            const pricePerSqm = totalPrice / area;

            resultDiv.style.display = 'none';
            loadingDiv.style.display = 'block';

            // 3. ‡∏à‡∏±‡∏î‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå
            const requestData = {
                price_per_sqm: pricePerSqm, // ‡∏™‡πà‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏µ‡πà‡∏´‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏õ‡πÉ‡∏´‡πâ‡∏´‡∏•‡∏±‡∏á‡∏ö‡πâ‡∏≤‡∏ô
                zone: zone,
                distance: distance,
                age: age
            };

            try {
                // ‚ö†Ô∏è ‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏°‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤ ngrok ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏¢‡∏±‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ô‡∏µ‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö (‡∏ñ‡πâ‡∏≤‡∏õ‡∏¥‡∏î ngrok ‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏≠‡∏≤‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÉ‡∏´‡∏°‡πà‡∏°‡∏≤‡πÅ‡∏õ‡∏∞‡∏ô‡∏∞)
                const response = await fetch('https://transisthmian-autoecious-tana.ngrok-free.dev/api/scan', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(requestData)
                });

                const data = await response.json();
                
                loadingDiv.style.display = 'none';
                resultDiv.style.display = 'block';

                if (data.status === 'success') {
                    resultDiv.className = 'success';
                    resultDiv.innerHTML = `‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡∏•‡∏á‡∏ó‡∏∏‡∏ô:<br><span class="score-number">${data.score} / 100</span>
                    <div class="calculation-note">(‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å‡∏£‡∏≤‡∏Ñ‡∏≤ ${pricePerSqm.toLocaleString(undefined, {maximumFractionDigits: 0})} ‡∏ö‡∏≤‡∏ó/‡∏ï‡∏£.‡∏°.)</div>
                    <small style="color: #475569; font-weight: normal;">‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏°‡∏≠‡∏á‡∏Å‡∏•: ${data.version}</small>`;
                } else {
                    resultDiv.className = 'error';
                    resultDiv.innerText = '‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏à‡∏≤‡∏Å‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå: ' + data.message;
                }

            } catch (error) {
                loadingDiv.style.display = 'none';
                resultDiv.style.display = 'block';
                resultDiv.className = 'error';
                resultDiv.innerText = 'üîå ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ (‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡∏¥‡∏î ngrok ‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏ô main.py ‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà)';
            }
        }
    </script>
</body>
</html>
